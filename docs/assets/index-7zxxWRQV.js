import{j as e,r as p}from"./react-DHBI0EtI.js";import{c as Ce}from"./react-dom-m0Soxutk.js";import{B as Se}from"./react-router-dom-C2IQ_L4I.js";import{u as le}from"./react-hook-form-TA_W7sgq.js";import{o as V}from"./mobx-react-lite-m5mAWZBZ.js";import{a as Y,r as re}from"./mobx-uTECe87D.js";import{a as S}from"./axios-CCb-kr4I.js";import{C as E,B as k,P as ce,a as D,T as g,b as W,I as de,c as $,V as me,d as he,e as pe,L as ue,f as De,g as ge,h as _e,i as Fe,A as ke,j as Le,F as Te,k as Pe,S as $e,M as v,l as Be,N as ae,E as Ee,D as Ae,m as xe,n as qe,o as Oe,p as Me,q as Ne,r as ze,s as ve,t as Re}from"./@mui-B_p6gauv.js";import{u as T,a as J,b as Ue,c as _}from"./react-router-DeS6GNwm.js";import{F as c,I as h,U as A,B as I,S as b,M as H,D as We,C as Ve,T as Je,a as He}from"./antd-B8W6f5DU.js";import{T as q}from"./@ant-design-D5eOVOcB.js";import"./classnames-C9FZUsQl.js";import"./scheduler-CzFDRTuY.js";import"./@remix-run-Cz6oGz3K.js";import"./use-sync-external-store-U2Sg9eXX.js";import"./react-is-DcfIKM1A.js";import"./@emotion-Su2HbLT9.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./@babel-BtPi2XIt.js";import"./stylis-YPZU7XtI.js";import"./clsx-B-dksMZM.js";import"./react-transition-group-BZCvRTj2.js";import"./rc-util-C-ojZSMc.js";import"./rc-resize-observer-Dks0eWPk.js";import"./resize-observer-polyfill-B1PUzC5B.js";import"./rc-motion-CcFStZqK.js";import"./@rc-component-DfeRbotr.js";import"./rc-overflow-Bujk3lLu.js";import"./rc-menu-vc2km0h8.js";import"./rc-select-D-y57sOE.js";import"./rc-virtual-list-IqqFrh-p.js";import"./rc-drawer-BNnyi9em.js";import"./rc-field-form-7mrhAhJA.js";import"./scroll-into-view-if-needed-BZeNfFF0.js";import"./compute-scroll-into-view-DWa9QgjM.js";import"./rc-dialog-CfOQNX7d.js";import"./rc-table-Hs4OUqHL.js";import"./rc-tree-DhyT1hpS.js";import"./rc-checkbox-BW0H7KXh.js";import"./rc-dropdown-B2dlau0p.js";import"./@ctrl-DOFZgDuz.js";import"./rc-pagination-CilJmSr7.js";import"./throttle-debounce-CUWDS_la.js";import"./rc-input-BHSlWDXb.js";import"./rc-textarea-_T4_NVPF.js";import"./rc-upload-Clc7D8kH.js";import"./rc-picker-BH4iOX9v.js";import"./rc-progress-CqLWRIDz.js";import"./rc-tooltip-Bl6SRsnU.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();const C={drills:"drills",drill:"drill",createDrill:"drill/create",updateDrill:"drill/update/",deleteDrill:"drill/delete/",archive_drills:"archive_drills",archive_drill:"archive_drill",screws:"screws",screw:"screw",createScrew:"screw/create",updateScrew:"screw/update/",deleteScrew:"screw/delete/",plates:"plates",plate:"plate",createPlate:"plate/create",updatePlate:"plate/update/",deletePlate:"plate/delete/",register:"auth/register",login:"auth/jwt/login"};class Ge{constructor(){this.isLoading=!1,this.error="",this.email=localStorage.getItem("authEmail")||"",this.isAuthenticated=!!this.email,Y(this)}async register(t,s){var a,n;this.setLoading(!0),this.setError("");try{await S.post(`https://gas159.ru/api/${C.register}`,{email:t,password:s}),this.isAuthenticated=!0}catch(i){this.setError(((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.detail)||"Произошла ошибка регистрации")}finally{this.setLoading(!1)}}async login(t,s){var a,n;this.setLoading(!0),this.setError("");try{await S.post(`https://gas159.ru/api/${C.login}`,{username:t,password:s},{headers:{"Content-Type":"application/x-www-form-urlencoded"},withCredentials:!0}),this.setEmail(t),this.isAuthenticated=!0}catch(i){this.setError(((n=(a=i.response)==null?void 0:a.data)==null?void 0:n.detail)||"Произошла ошибка входа")}finally{this.setLoading(!1)}}logout(){this.isAuthenticated=!1,localStorage.removeItem("authEmail")}setLoading(t){this.isLoading=t}setError(t){this.error=t}setEmail(t){this.email=t,localStorage.setItem("authEmail",t)}}const y=new Ge,Ke=()=>{const[r,t]=p.useState(!1),{register:s,handleSubmit:a,formState:{errors:n}}=le(),i=()=>t(u=>!u),o=u=>{u.preventDefault()},m=()=>{l("/")},l=T();return{register:s,handleSubmit:a,errors:n,showPassword:r,handleClickShowPassword:i,handleMouseDownPassword:o,handleBack:m,onSubmit:async u=>{await y.login(u.email,u.password),y.error||l("/")},navigate:l}},ne={"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#000"}},"& .MuiInputLabel-root":{"&.Mui-focused":{color:"#000"}}},Xe=V(()=>{const{register:r,handleSubmit:t,errors:s,showPassword:a,handleClickShowPassword:n,handleMouseDownPassword:i,handleBack:o,onSubmit:m,navigate:l}=Ke();return e.jsxs(E,{component:"main",maxWidth:"xs",sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh"},children:[e.jsx(k,{onClick:o,sx:{marginBottom:4},children:"Назад"}),e.jsx(ce,{elevation:3,sx:{padding:4,width:"100%"},children:e.jsxs(D,{component:"form",onSubmit:t(m),children:[e.jsx(g,{variant:"h4",gutterBottom:!0,align:"center",children:"Авторизация"}),e.jsx(W,{label:"Email",...r("email",{required:"Введите email"}),error:!!s.email,helperText:s.email?String(s.email.message):"",fullWidth:!0,margin:"normal",sx:ne}),e.jsx(W,{label:"Пароль",type:a?"text":"password",...r("password",{required:"Введите пароль"}),error:!!s.password,helperText:s.password?String(s.password.message):"",fullWidth:!0,margin:"normal",sx:ne,InputProps:{endAdornment:e.jsx(de,{position:"end",children:e.jsx($,{"aria-label":"toggle password visibility",onClick:n,onMouseDown:i,edge:"end",children:a?e.jsx(me,{}):e.jsx(he,{})})})}}),e.jsx(k,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2,borderRadius:"20px",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},disabled:y.isLoading,children:y.isLoading?e.jsx(pe,{size:24,sx:{color:"white"}}):"Войти"}),y.error&&e.jsx(g,{color:"error",align:"center",sx:{mt:2},children:y.error}),e.jsxs(g,{variant:"body2",align:"center",sx:{mt:2},children:["Нет аккаунта?"," ",e.jsx(ue,{onClick:()=>l("/register"),sx:{textDecoration:"none",cursor:"pointer"},children:"Регистрация"})]})]})})]})}),Qe=()=>{const[r,t]=p.useState(!1),{register:s,handleSubmit:a,formState:{errors:n}}=le(),i=()=>t(u=>!u),o=u=>{u.preventDefault()},m=()=>{l("/")},l=T();return{register:s,handleSubmit:a,errors:n,showPassword:r,handleClickShowPassword:i,handleMouseDownPassword:o,handleBack:m,onSubmit:async u=>{await y.register(u.email,u.password),y.error||l("/login")},navigate:l}},ie={"& .MuiOutlinedInput-root":{"&.Mui-focused fieldset":{borderColor:"#000"}},"& .MuiInputLabel-root":{"&.Mui-focused":{color:"#000"}}},Ye=V(()=>{const{register:r,handleSubmit:t,errors:s,showPassword:a,handleClickShowPassword:n,handleMouseDownPassword:i,handleBack:o,onSubmit:m,navigate:l}=Qe();return e.jsxs(E,{component:"main",maxWidth:"xs",sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh"},children:[e.jsx(k,{onClick:o,sx:{marginBottom:4},children:"Назад"}),e.jsx(ce,{elevation:3,sx:{padding:4,width:"100%"},children:e.jsxs(D,{component:"form",onSubmit:t(m),children:[e.jsx(g,{variant:"h4",gutterBottom:!0,align:"center",children:"Регистрация"}),e.jsx(W,{label:"Email",...r("email",{required:"Введите email"}),error:!!s.email,helperText:s.email?String(s.email.message):"",fullWidth:!0,margin:"normal",sx:ie}),e.jsx(W,{label:"Пароль",type:a?"text":"password",...r("password",{required:"Введите пароль"}),error:!!s.password,helperText:s.password?String(s.password.message):"",fullWidth:!0,margin:"normal",sx:ie,InputProps:{endAdornment:e.jsx(de,{position:"end",children:e.jsx($,{"aria-label":"toggle password visibility",onClick:n,onMouseDown:i,edge:"end",children:a?e.jsx(me,{}):e.jsx(he,{})})})}}),e.jsx(k,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2,borderRadius:"20px",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},disabled:y.isLoading,children:y.isLoading?e.jsx(pe,{size:24,sx:{color:"white"}}):"Регистрация"}),y.error&&e.jsx(g,{color:"error",align:"center",sx:{mt:2},children:y.error}),e.jsxs(g,{variant:"body2",align:"center",sx:{mt:2},children:["Уже есть аккаунт?"," ",e.jsx(ue,{onClick:()=>l("/login"),sx:{textDecoration:"none",cursor:"pointer"},children:"Войти"})]})]})})]})}),oe={palette:{primary:De}},Ze=()=>{const r=localStorage.getItem("colorTheme"),[t,s]=p.useState(r||"light"),a=()=>{s(i=>{const o=i==="light"?"dark":"light";return localStorage.setItem("colorTheme",o),o})};return{theme:p.useMemo(()=>ge({...oe,palette:{...oe.palette,mode:t}}),[t]),mode:t,toggleColorMode:a}},je=p.createContext({mode:"light",toggleColorMode:()=>{},theme:ge()}),et=({children:r})=>{const t=Ze();return e.jsxs(je.Provider,{value:t,children:[" ",r," "]})},O=()=>p.useContext(je),tt=()=>{const{mode:r,toggleColorMode:t}=O();return e.jsx(D,{children:e.jsx($,{sx:{ml:1},onClick:t,color:"inherit",children:r==="dark"?e.jsx(_e,{}):e.jsx(Fe,{})})})},fe=()=>(p.useEffect(()=>{const r=localStorage.getItem("authEmail");r&&(y.isAuthenticated=!0,y.email=r)},[]),{isAuthenticated:y.isAuthenticated,email:y.email,login:y.login.bind(y),logout:y.logout.bind(y),register:y.register.bind(y)}),Z=()=>{const r=T(),{isAuthenticated:t}=fe(),s=()=>{r("/login")},a=()=>{r("/account")},n=()=>{r("/")};return e.jsx(ke,{position:"static",color:"primary",children:e.jsxs(Le,{children:[e.jsx(g,{variant:"h6",component:"p",onClick:n,sx:{flexGrow:1,cursor:"pointer"},children:"Tool Manager"}),e.jsx(tt,{}),t?e.jsx(k,{onClick:a,sx:{color:"white"},children:"Личный кабинет"}):e.jsx(k,{onClick:s,sx:{color:"white"},children:"Login"})]})})},ye=()=>{const[r,t]=p.useState(""),s=T(),a=J().pathname.slice(1);p.useEffect(()=>{t(a||"")},[a]);const n=i=>{const o=i.target.value;t(o)};return e.jsx(e.Fragment,{children:e.jsxs(Te,{fullWidth:!0,variant:"outlined",sx:{width:"200px",m:"10px"},children:[e.jsx(Pe,{id:"tools-dropdown-label",children:"Инструменты"}),e.jsxs($e,{labelId:"tools-dropdown-label",value:r,onChange:n,label:"Инструменты",children:[e.jsx(v,{value:"drills",onClick:()=>s("/drills"),children:"Сверла"}),e.jsx(v,{value:"screws",onClick:()=>s("/screws"),children:"Винты"}),e.jsx(v,{value:"plates",onClick:()=>s("/plates"),children:"Пластины"}),e.jsx(v,{value:"archive_drills",onClick:()=>s("/archive_drills"),children:"Архив"})]})]})})},st=()=>e.jsxs(e.Fragment,{children:[e.jsx(Z,{}),e.jsx(ye,{})]}),z=async(r="")=>{try{const t=r==="drills"?`?broken=${w.isBroken}`:"";return(await S.get(`https://gas159.ru/api/${r}${t}`)).data}catch(t){console.log(t)}},G=async(r,t)=>{try{return(await S.get(`https://gas159.ru/api/${C[t]}/${r}`)).data}catch(s){console.log(s)}},rt=async r=>{const t=new FormData,s={name:r.name,diameter:Number(r.diameter),length_xD:Number(r.length_xD),deep_of_drill:Number(r.deep_of_drill),key:r.key,company:r.company,is_broken:r.is_broken,storage:r.storage,description:r.description};t.append("drill",JSON.stringify(s)),t.append("screws_ids",String([r.screws])),t.append("plates_ids",String([r.plates])),r.images&&r.images.length>0&&r.images.forEach(a=>{const n=a,i=n.originFileObj||n;t.append("images",i)});try{const a=await S.post(`https://gas159.ru/api/${C.createDrill}`,t,{headers:{"Content-Type":"multipart/form-data"}});return console.log("Форма успешно отправлена!"),console.log(a),{message:"Форма успешно отправлена!"}}catch(a){throw console.error("Возникла ошибка при отправке формы:",a),a}},at=async(r,t)=>{console.log(t.images);const s=new FormData,a={name:t.name,diameter:Number(t.diameter),length_xD:Number(t.length_xD),deep_of_drill:Number(t.deep_of_drill),key:t.key,company:t.company,is_broken:t.is_broken,storage:t.storage,description:t.description};s.append("drill",JSON.stringify(a)),s.append("screws_ids",String([t.screws])),s.append("plates_ids",String([t.plates]));const n=async(i,o,m)=>{const d=await(await fetch(i)).blob();return new File([d],o,{type:m})};if(t.images&&t.images.length>0){const i=t.images.filter(l=>!l.originFileObj).map(l=>{const d=l;return n(d.url,d.name,"image/png")}),o=t.images.filter(l=>l.originFileObj);(await Promise.all(i)).forEach(l=>{s.append("images",l)}),o.forEach(l=>{const d=l;s.append("images",d.originFileObj)})}try{const i=await S.put(`https://gas159.ru/api/${C.updateDrill}${r}`,s,{headers:{"Content-Type":"multipart/form-data"}});return console.log("Данные успешно обновлены!"),console.log(i),{message:"Данные успешно обновлены!"}}catch(i){throw console.error("Возникла ошибка при обновлении данных:",i),i}},nt=async(r,t)=>{const s=t==="drills"?C.deleteDrill:t==="screws"?C.deleteScrew:t==="plates"?C.deletePlate:void 0;try{const a={headers:{"Content-Type":"application/json"}},n=await S.delete(`https://gas159.ru/api/${s}${r}`,a);return w.getDetails(t),n.data}catch(a){console.log(a)}},it=async r=>{const t=new FormData,s={type:r.type,length:Number(r.length),thread:r.thread,step_of_thread:Number(r.step_of_thread),company:r.company,description:r.description};t.append("screw",JSON.stringify(s)),r.images&&r.images.length>0&&r.images.forEach(a=>{const n=a,i=n.originFileObj||n;t.append("images",i)});try{const a=await S.post(`https://gas159.ru/api/${C.createScrew}`,t,{headers:{"Content-Type":"multipart/form-data"}});return console.log("Форма успешно отправлена для винта!"),console.log(a),a.data}catch(a){throw console.error("Возникла ошибка при отправке формы для винта:",a),a}},ot=async r=>{const t=new FormData,s={type:r.type,sub_type:r.sub_type,material:r.material,amount:Number(r.amount),min_amount:Number(r.min_amount),company:r.company,description:r.description};t.append("plate",JSON.stringify(s)),r.images&&r.images.length>0&&r.images.forEach(a=>{const n=a,i=n.originFileObj||n;t.append("images",i)});try{const a=await S.post(`https://gas159.ru/api/${C.createPlate}`,t,{headers:{"Content-Type":"multipart/form-data"}});return console.log("Форма успешно отправлена для пластины!"),console.log(a),a.data}catch(a){throw console.error("Возникла ошибка при отправке формы для пластины:",a),a}},lt=async(r,t)=>{const s=new FormData,a={type:t.type,sub_type:t.sub_type,material:t.material,amount:Number(t.amount),min_amount:Number(t.min_amount),company:t.company,description:t.description};s.append("plate",JSON.stringify(a));const n=async(i,o,m)=>{const d=await(await fetch(i)).blob();return new File([d],o,{type:m})};if(t.images&&t.images.length>0){const i=t.images.filter(l=>!l.originFileObj).map(l=>{const d=l;return n(d.url,d.name,"image/png")}),o=t.images.filter(l=>l.originFileObj);(await Promise.all(i)).forEach(l=>{s.append("images",l)}),o.forEach(l=>{const d=l;s.append("images",d.originFileObj)})}try{const i=await S.put(`https://gas159.ru/api/${C.updatePlate}${r}`,s,{headers:{"Content-Type":"multipart/form-data"}});return console.log(i),console.log("Пластина успешно обновлена!"),{message:"Пластина успешно обновлена!"}}catch(i){throw console.error("Ошибка при обновлении пластины:",i),i}},ct=async(r,t)=>{const s=new FormData,a={type:t.type,length:Number(t.length),thread:t.thread,step_of_thread:Number(t.step_of_thread),company:t.company,description:t.description};s.append("screw",JSON.stringify(a));const n=async(i,o,m)=>{const d=await(await fetch(i)).blob();return new File([d],o,{type:m})};if(t.images&&t.images.length>0){const i=t.images.filter(l=>!l.originFileObj).map(l=>{const d=l;return n(d.url,d.name,"image/png")}),o=t.images.filter(l=>l.originFileObj);(await Promise.all(i)).forEach(l=>{s.append("images",l)}),o.forEach(l=>{const d=l;s.append("images",d.originFileObj)})}try{const i=await S.put(`https://gas159.ru/api/${C.updateScrew}${r}`,s,{headers:{"Content-Type":"multipart/form-data"}});return console.log(i),console.log("Винт успешно обновлен!"),{message:"Винт успешно обновлен!"}}catch(i){throw console.error("Ошибка при обновлении винта:",i),i}};class dt{constructor(){this.details=[],this.isError=!1,this.isBroken=!1,this.idDetailEdit=null,this.idDetailDescription=null,Y(this,{},{autoBind:!0})}async getDetails(t){this.isError=!1;try{const s=await z(C[t]);re(()=>{this.details=s,this.details.length>0&&(this.idDetailDescription=this.details[0].id)})}catch(s){re(()=>{this.isError=!0}),console.error("Failed to fetch drills:",s)}}getDetailsParameters(t){switch(t){case"drills":return this.getDiameters();case"screws":return this.getScrewsLength();case"plates":return this.getPlatesAmount();case"archive_drills":return this.getDiameters()}}getDiameters(){if(!this.details||!this.details.length)return[];const t=this.details.map(s=>s.diameter);return Array.from(new Set(t)).sort((s,a)=>s-a)}getScrewsLength(){return!this.details||!this.details.length?[]:Array.from(new Set(this.details.map(t=>t.length))).sort((t,s)=>t-s)}getPlatesAmount(){return!this.details||!this.details.length?[]:Array.from(new Set(this.details.map(t=>t.amount))).sort((t,s)=>t-s)}handleIsBroken(){this.isBroken=!this.isBroken,this.getDetails("drills")}getDetailIdEdit(t){this.idDetailEdit=t}getDetailIdDescription(t){this.idDetailDescription=t}}const w=new dt,mt={labelCol:{span:6},wrapperCol:{span:16}},ht={wrapperCol:{offset:6,span:16}},pt=({onSubmit:r,onSuccess:t})=>{const[s]=c.useForm(),[a,n]=p.useState([]),i=({fileList:o})=>{n(o)};return e.jsxs(c,{form:s,...mt,name:"screwForm",initialValues:{type:"",length:1,thread:"",step_of_thread:.1,company:"",description:"",image_path:""},onFinish:async o=>{o.images=a;try{await r(o),t(),s.resetFields(),n([])}catch(m){alert(`Error submitting form: ${m||"Unknown error"}`)}},children:[e.jsx(c.Item,{label:"Тип",name:"type",rules:[{required:!0,message:"Введите тип!"}],children:e.jsx(h,{placeholder:"Введите тип винта"})}),e.jsx(c.Item,{label:"Длина",name:"length",rules:[{required:!0,message:"Введите длину!"}],children:e.jsx(h,{type:"number",placeholder:"Введите длину"})}),e.jsx(c.Item,{label:"Резьба",name:"thread",rules:[{required:!0,message:"Введите тип резьбы!"}],children:e.jsx(h,{placeholder:"Введите резьбу"})}),e.jsx(c.Item,{label:"Шаг резьбы",name:"step_of_thread",rules:[{required:!0,message:"Введите шаг резьбы!"}],children:e.jsx(h,{type:"number",placeholder:"Введите шаг резьбы"})}),e.jsx(c.Item,{label:"Компания",name:"company",rules:[{required:!0,message:"Введите название компании!"}],children:e.jsx(h,{placeholder:"Введите название компании"})}),e.jsx(c.Item,{label:"Описание",name:"description",rules:[{required:!0,message:"Введите описание!"}],children:e.jsx(h.TextArea,{rows:4,placeholder:"Введите описание"})}),e.jsx(c.Item,{label:"Изображение",name:"image_path",children:e.jsx(A,{fileList:a,onChange:i,children:e.jsx(I,{icon:e.jsx(q,{}),children:"Загрузить изображение"})})}),e.jsx(c.Item,{...ht,children:e.jsx(I,{type:"primary",htmlType:"submit",children:"Отправить"})})]})},ut={labelCol:{span:6},wrapperCol:{span:16}},gt={wrapperCol:{offset:6,span:16}},xt=({onSubmit:r,onSuccess:t})=>{const[s]=c.useForm(),[a,n]=p.useState([]),i=({fileList:o})=>{n(o)};return e.jsxs(c,{form:s,...ut,name:"plateForm",initialValues:{type:"",sub_type:"",material:"",amount:1,company:"",description:"",image_path:""},onFinish:async o=>{o.images=a;try{await r(o),t(),s.resetFields(),n([])}catch(m){alert(`Error submitting form: ${m||"Unknown error"}`)}},children:[e.jsx(c.Item,{label:"Тип",name:"type",rules:[{required:!0,message:"Введите тип!"}],children:e.jsx(h,{placeholder:"Введите тип пластины"})}),e.jsx(c.Item,{label:"Подтип",name:"sub_type",rules:[{required:!0,message:"Введите подтип!"}],children:e.jsx(h,{placeholder:"Введите подтип"})}),e.jsx(c.Item,{label:"Материал",name:"material",rules:[{required:!0,message:"Выберите материал!"}],children:e.jsxs(b,{placeholder:"Выберите материал",children:[e.jsx(b.Option,{value:"m",children:"M"}),e.jsx(b.Option,{value:"s",children:"S"}),e.jsx(b.Option,{value:"x",children:"X"})]})}),e.jsx(c.Item,{label:"Количество",name:"amount",rules:[{required:!0,message:"Введите количество!"}],children:e.jsx(h,{type:"number",placeholder:"Введите количество"})}),e.jsx(c.Item,{label:"Компания",name:"company",rules:[{required:!0,message:"Введите название компании!"}],children:e.jsx(h,{placeholder:"Введите название компании"})}),e.jsx(c.Item,{label:"Описание",name:"description",rules:[{required:!0,message:"Введите описание!"}],children:e.jsx(h.TextArea,{rows:4,placeholder:"Введите описание"})}),e.jsx(c.Item,{label:"Изображение",name:"image_path",children:e.jsx(A,{fileList:a,onChange:i,children:e.jsx(I,{icon:e.jsx(q,{}),children:"Загрузить изображение"})})}),e.jsx(c.Item,{...gt,children:e.jsx(I,{type:"primary",htmlType:"submit",children:"Отправить"})})]})},jt=()=>{const[r,t]=p.useState([]),[s,a]=p.useState([]);return p.useEffect(()=>{const n=async()=>{const o=await z("screws");t(o)},i=async()=>{const o=await z("plates");a(o)};n(),i()},[]),{screws:r,plates:s}},ft={labelCol:{span:6},wrapperCol:{span:16}},yt={wrapperCol:{offset:6,span:16}},wt=({onSubmit:r,onSuccess:t})=>{const[s]=c.useForm(),{mode:a}=O(),{screws:n,plates:i}=jt(),[o,m]=p.useState([]),l=({fileList:d})=>{m(d)};return e.jsxs(c,{className:a==="light"?"light-theme":"dark-theme",form:s,...ft,name:"basic",initialValues:{name:"new",diameter:.5,length_xD:10,deep_of_drill:10,key:"newKey",company:"newCompany",is_broken:!1,storage:"newStorage",description:"hello"},onFinish:async d=>{d.images=o;try{await r(d),t(),s.resetFields(),m([])}catch(u){alert(`Возникла ошибка при отправке формы: ${(u==null?void 0:u.message)??"Неизвестная ошибка"}`)}},children:[e.jsx(c.Item,{label:"Название",name:"name",rules:[{required:!0,message:"Пожалуйста, введите название!"}],children:e.jsx(h,{placeholder:"Пожалуйста, введите название"})}),e.jsx(c.Item,{label:"Диаметр",name:"diameter",rules:[{required:!0,message:"Пожалуйста, введите диаметр!"}],children:e.jsx(h,{type:"number",placeholder:"Пожалуйста, введите диаметр"})}),e.jsx(c.Item,{label:"Длина",name:"length_xD",rules:[{required:!0,message:"Пожалуйста, введите длину!"}],children:e.jsx(h,{type:"number",placeholder:"Пожалуйста, введите длину"})}),e.jsx(c.Item,{label:"Глубина сверления",name:"deep_of_drill",rules:[{required:!0,message:"Пожалуйста, введите глубину сверления!"}],children:e.jsx(h,{type:"number",placeholder:"Пожалуйста, введите глубину сверления"})}),e.jsx(c.Item,{label:"Ключ",name:"key",rules:[{required:!0,message:"Пожалуйста, введите название ключа!"}],children:e.jsx(h,{placeholder:"Пожалуйста, введите название ключа"})}),e.jsx(c.Item,{label:"Компания",name:"company",rules:[{required:!0,message:"Пожалуйста, введите название компании!"}],children:e.jsx(h,{placeholder:"Пожалуйста, введите название компании"})}),e.jsx(c.Item,{label:"Состояние",name:"is_broken",rules:[{required:!0,message:"Пожалуйста, выберите состояние!"}],children:e.jsxs(b,{style:{width:"100%"},children:[e.jsx(b.Option,{value:!1,children:"Исправно"}),e.jsx(b.Option,{value:!0,children:"Сломанно"})]})}),e.jsx(c.Item,{label:"Винты",name:"screws",rules:[{required:!0,message:"Пожалуйста, выберите винт!"}],children:e.jsx(b,{mode:"multiple",placeholder:"Выберите винт...",children:n.map(d=>e.jsx(b.Option,{value:d.id,children:d.type},d.id))})}),e.jsx(c.Item,{label:"Пластины",name:"plates",rules:[{required:!0,message:"Пожалуйста, выберите пластину!"}],children:e.jsx(b,{mode:"multiple",placeholder:"Выберите пластину...",children:i.map(d=>e.jsx(b.Option,{value:d.id,children:d.type},d.id))})}),e.jsx(c.Item,{label:"Изображение",name:"images",children:e.jsx(A,{fileList:o,onChange:l,children:e.jsx(I,{icon:e.jsx(q,{}),children:"Нажмите, чтобы загрузить"})})}),e.jsx(c.Item,{label:"Описание",name:"description",rules:[{required:!0,message:"Пожалуйста, предоставьте описание!"}],children:e.jsx(h.TextArea,{rows:4,placeholder:"Пожалуйста, введите подробное описание"})}),e.jsx(c.Item,{...yt,children:e.jsx(I,{type:"primary",htmlType:"submit",children:"Отправить"})})]})},bt=({activeItems:r})=>{const[t,s]=p.useState(!1),{mode:a}=O(),n=()=>{s(!1)},i=()=>{s(!1),w.getDetails(r)},o=()=>{switch(r){case"drills":return e.jsx(wt,{onSubmit:rt,onSuccess:i});case"screws":return e.jsx(pt,{onSubmit:it,onSuccess:i});case"plates":return e.jsx(xt,{onSubmit:ot,onSuccess:i});default:return null}};return e.jsxs(e.Fragment,{children:[e.jsxs(I,{type:"primary",onClick:()=>s(!0),children:["Добавить ",r==="drills"?"сверло":r==="screws"?"винт":"пластину"]}),e.jsx(H,{className:a==="light"?"light-theme":"dark-theme",title:`Добавление ${r==="drills"?"сверла":r==="screws"?"винта":"пластины"}`,open:t,footer:null,onCancel:n,children:o()})]})},It=({openFilter:r,activeItems:t})=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"10px"},children:[e.jsx(I,{type:"primary",onClick:r,children:"Фильтры"}),t!=="archive_drills"&&e.jsx(bt,{activeItems:t})]}),Ct=({closeFilterDrawer:r,drawerVisible:t,setSelectedParameters:s,selectedParameters:a,resetFilter:n})=>{const{mode:i}=O(),o=J().pathname.slice(1),[m,l]=p.useState([]);return p.useEffect(()=>{t&&(async()=>{await w.getDetails(o);const u=w.getDetailsParameters(o);if(Array.isArray(u)){const j=Array.from(new Set(u.filter(f=>f!==void 0)));l(j.map(f=>({label:`${f} мм`,value:f})))}else l([]);t&&s(a)})()},[o,t,a,s]),e.jsx(We,{title:"Фильтрация по диаметрам",placement:"right",onClose:r,open:t,className:i==="light"?"light-theme":"dark-theme",children:e.jsxs("div",{children:[o==="drills"&&e.jsxs("label",{children:["Показать сломанные",e.jsx(Be,{checked:w.isBroken,onChange:()=>w.handleIsBroken()})]}),e.jsx("h3",{children:"Выберите диаметры:"}),e.jsx(Ve.Group,{options:m,onChange:s,value:a,style:{display:"flex",flexDirection:"column"}}),e.jsxs("div",{style:{marginTop:"10px",display:"flex",justifyContent:"space-between"},children:[e.jsx(I,{onClick:n,children:"Сброс"}),e.jsx(I,{type:"primary",onClick:r,children:"Применить фильтр"})]})]})})},ee={title:"Изображение",dataIndex:"image_path",render:r=>{if(!r)return e.jsx(ae,{fontSize:"large"});const t=r.split(",")[0].trim(),s=`https://gas159.ru/api/${t}`;return e.jsx(e.Fragment,{children:t?e.jsx("img",{src:s,alt:"Изображение не найдено",style:{width:"50px",height:"50px",objectFit:"contain",border:"1px solid #e0e0e0"}}):e.jsx(ae,{fontSize:"large"})})}};function te(r,t){return{title:"Действия",render:(s,a)=>e.jsxs(e.Fragment,{children:[e.jsx($,{edge:"start",color:"inherit",onClick:()=>r(a.id),children:e.jsx(Ee,{})}),e.jsx($,{edge:"end",color:"inherit",onClick:()=>nt(a.id,t),children:e.jsx(Ae,{})})]})}}const X=r=>[{title:"ID",dataIndex:"id",sorter:(t,s)=>t.id-s.id,sortDirections:["ascend","descend"]},{title:"Название",dataIndex:"name",sorter:(t,s)=>t.name.toLowerCase().localeCompare(s.name.toLowerCase()),sortDirections:["ascend","descend"]},{title:"Диаметр",dataIndex:"diameter",sorter:(t,s)=>t.diameter-s.diameter,sortDirections:["ascend","descend"],render:(t,s)=>e.jsxs("span",{children:[s.diameter," мм"]})},{title:"Длинна",dataIndex:"length_xD",sorter:(t,s)=>t.length_xD-s.length_xD,sortDirections:["ascend","descend"]},{title:"Глубина сверления",dataIndex:"deep_of_drill",sorter:(t,s)=>t.deep_of_drill-s.deep_of_drill,sortDirections:["ascend","descend"]},{title:"Компания",dataIndex:"company",sorter:(t,s)=>t.company.toLowerCase().localeCompare(s.company.toLowerCase()),sortDirections:["ascend","descend"]},{title:"Винты",render:(t,s)=>{var a;return e.jsx("select",{defaultValue:"Винты",children:(a=s.screws)==null?void 0:a.map(n=>e.jsx("option",{children:n.type},n.id))})}},{title:"Пластины",render:(t,s)=>{var a;return e.jsx("select",{defaultValue:"Пластины",children:(a=s.plates)==null?void 0:a.map(n=>e.jsx("option",{children:n.type},n.id))})}},ee,te(r,"drills")],St=r=>[{title:"ID",dataIndex:"id",sorter:(t,s)=>t.id-s.id,sortDirections:["ascend","descend"]},{title:"Тип",dataIndex:"type",sorter:(t,s)=>t.type.toLowerCase().localeCompare(s.type.toLowerCase()),sortDirections:["ascend","descend"]},{title:"Длина",dataIndex:"length",sorter:(t,s)=>t.length-s.length,sortDirections:["ascend","descend"],render:(t,s)=>e.jsxs("span",{children:[s.length," мм"]})},{title:"Резьба",dataIndex:"thread",sorter:(t,s)=>t.company.toLowerCase().localeCompare(s.company.toLowerCase()),sortDirections:["ascend","descend"]},{title:"Шаг резьбы",dataIndex:"step_of_thread",sorter:(t,s)=>t.step_of_thread-s.step_of_thread,sortDirections:["ascend","descend"]},{title:"Компания",dataIndex:"company",sorter:(t,s)=>t.company.toLowerCase().localeCompare(s.company.toLowerCase()),sortDirections:["ascend","descend"]},ee,te(r,"screws")],Dt=r=>[{title:"ID",dataIndex:"id",sorter:(t,s)=>t.id-s.id,sortDirections:["ascend","descend"]},{title:"Тип",dataIndex:"type",sorter:(t,s)=>t.type.toLowerCase().localeCompare(s.type.toLowerCase()),sortDirections:["ascend","descend"]},{title:"Подтип",dataIndex:"sub_type",sorter:(t,s)=>t.type.toLowerCase().localeCompare(s.type.toLowerCase()),sortDirections:["ascend","descend"]},{title:"Материал",dataIndex:"material",sorter:(t,s)=>t.company.toLowerCase().localeCompare(s.company.toLowerCase()),sortDirections:["ascend","descend"]},{title:"Количество",dataIndex:"amount",sorter:(t,s)=>t.length-s.length,sortDirections:["ascend","descend"]},{title:"Компания",dataIndex:"company",sorter:(t,s)=>t.company.toLowerCase().localeCompare(s.company.toLowerCase()),sortDirections:["ascend","descend"]},ee,te(r,"plates")],_t=({id:r,visible:t,onClose:s,activeItem:a})=>{const[n]=c.useForm(),[i,o]=p.useState([]),[m,l]=p.useState([]),[d,u]=p.useState([]),[j,f]=p.useState(!1),P={labelCol:{span:6},wrapperCol:{span:16}},L={wrapperCol:{offset:6,span:16}};p.useEffect(()=>{(async()=>{if(r&&t){const B=await G(r,a.slice(0,-1));if(B){n.setFieldsValue({...B,screws:B.screws.map(N=>N.id)||[],plates:B.plates.map(N=>N.id)||[]});const Ie=B.image_path?B.image_path.split(",").map((N,se)=>({uid:se,name:`image-${se}`,status:"done",url:`https://gas159.ru/api/${N.trim()}`})):[];o(Ie)}}const M=await z("screws");l(M);const be=await z("plates");u(be)})()},[r,t,n,a]);const F=({fileList:x})=>{o(x)},K=async x=>{f(!0);try{x.images=i,await at(r,x),w.getDetails("drills"),s()}catch(M){console.error("Ошибка при обновлении данных:",M)}finally{f(!1)}};return e.jsx(H,{title:"Редактирование сверла",open:t,footer:null,onCancel:s,children:e.jsxs(c,{form:n,onFinish:K,...P,initialValues:{screws:[],plates:[],images:[]},children:[e.jsx(c.Item,{label:"Название",name:"name",rules:[{required:!0,message:"Пожалуйста, введите название!"}],children:e.jsx(h,{placeholder:"Пожалуйста, введите название"})}),e.jsx(c.Item,{label:"Диаметр",name:"diameter",rules:[{required:!0,message:"Пожалуйста, введите диаметр!"}],children:e.jsx(h,{type:"number",placeholder:"Пожалуйста, введите диаметр"})}),e.jsx(c.Item,{label:"Длина",name:"length_xD",rules:[{required:!0,message:"Пожалуйста, введите длину!"}],children:e.jsx(h,{type:"number",placeholder:"Пожалуйста, введите длину"})}),e.jsx(c.Item,{label:"Глубина сверления",name:"deep_of_drill",rules:[{required:!0,message:"Пожалуйста, введите глубину сверления!"}],children:e.jsx(h,{type:"number",placeholder:"Пожалуйста, введите глубину сверления"})}),e.jsx(c.Item,{label:"Ключ",name:"key",rules:[{required:!0,message:"Пожалуйста, введите название ключа!"}],children:e.jsx(h,{placeholder:"Пожалуйста, введите название ключа"})}),e.jsx(c.Item,{label:"Компания",name:"company",rules:[{required:!0,message:"Пожалуйста, введите название компании!"}],children:e.jsx(h,{placeholder:"Пожалуйста, введите название компании"})}),e.jsx(c.Item,{label:"Состояние",name:"is_broken",rules:[{required:!0,message:"Пожалуйста, выберите состояние!"}],children:e.jsxs(b,{style:{width:"100%"},children:[e.jsx(b.Option,{value:!1,children:"Исправно"}),e.jsx(b.Option,{value:!0,children:"Сломанно"})]})}),e.jsx(c.Item,{label:"Винты",name:"screws",rules:[{required:!0,message:"Пожалуйста, выберите винт!"}],children:e.jsx(b,{mode:"multiple",style:{width:"100%"},placeholder:"Выберите винт...",children:m.map(x=>e.jsx(b.Option,{value:x.id,children:x.type},x.id))})}),e.jsx(c.Item,{label:"Пластины",name:"plates",rules:[{required:!0,message:"Пожалуйста, выберите пластину!"}],children:e.jsx(b,{mode:"multiple",style:{width:"100%"},placeholder:"Выберите пластину...",children:d.map(x=>e.jsx(b.Option,{value:x.id,children:x.type},x.id))})}),e.jsx(c.Item,{label:"Место хранения",name:"storage",rules:[{required:!0,message:"Пожалуйста, выберите место хранения!"}],children:e.jsx(h,{placeholder:"Пожалуйста, выберите место хранения"})}),e.jsx(c.Item,{label:"Изображение",name:"images",children:e.jsx(A,{fileList:i,onChange:F,beforeUpload:()=>!1,children:e.jsx(I,{icon:e.jsx(q,{}),children:"Нажмите, чтобы загрузить"})})}),e.jsx(c.Item,{label:"Описание",name:"description",rules:[{required:!0,message:"Пожалуйста, предоставьте описание!"}],children:e.jsx(h.TextArea,{rows:4,placeholder:"Пожалуйста, введите подробное описание"})}),e.jsx(c.Item,{...L,children:e.jsx(I,{type:"primary",htmlType:"submit",loading:j,children:"Сохранить изменения"})})]})})},Ft=({id:r,visible:t,onClose:s,activeItem:a})=>{const[n]=c.useForm(),[i,o]=p.useState([]),[m,l]=p.useState(!1);p.useEffect(()=>{(async()=>{if(r&&t){const f=await G(r,a.slice(0,-1));if(f){n.setFieldsValue({...f});const P=f.image_path?f.image_path.split(",").map((L,F)=>({uid:F.toString(),name:`image-${F}`,status:"done",url:`https://gas159.ru/api/${L.trim()}`})):[];o(P)}}})()},[r,t,n,a]);const d=({fileList:j})=>{o(j)},u=async j=>{l(!0);try{j.images=i,await ct(r,j),w.getDetails("screws"),s()}catch(f){console.error("Ошибка при обновлении данных:",f)}finally{l(!1)}};return e.jsx(H,{title:"Редактирование винта",open:t,footer:null,onCancel:s,children:e.jsxs(c,{form:n,onFinish:u,children:[e.jsx(c.Item,{label:"Тип",name:"type",rules:[{required:!0,message:"Введите тип!"}],children:e.jsx(h,{})}),e.jsx(c.Item,{label:"Длина",name:"length",rules:[{required:!0,message:"Введите длину!"}],children:e.jsx(h,{type:"number"})}),e.jsx(c.Item,{label:"Резьба",name:"thread",rules:[{required:!0,message:"Введите тип резьбы!"}],children:e.jsx(h,{})}),e.jsx(c.Item,{label:"Шаг резьбы",name:"step_of_thread",rules:[{required:!0,message:"Введите шаг!"}],children:e.jsx(h,{type:"number"})}),e.jsx(c.Item,{label:"Компания",name:"company",rules:[{required:!0,message:"Введите компанию!"}],children:e.jsx(h,{})}),e.jsx(c.Item,{label:"Изображение",name:"images",children:e.jsx(A,{fileList:i,onChange:d,beforeUpload:()=>!1,children:e.jsx(I,{icon:e.jsx(q,{}),children:"Нажмите, чтобы загрузить"})})}),e.jsx(c.Item,{label:"Описание",name:"description",children:e.jsx(h.TextArea,{rows:4})}),e.jsx(I,{type:"primary",htmlType:"submit",loading:m,children:"Сохранить изменения"})]})})},kt=({id:r,visible:t,onClose:s,activeItem:a})=>{const[n]=c.useForm(),[i,o]=p.useState([]),[m,l]=p.useState(!1);p.useEffect(()=>{(async()=>{if(r&&t){const f=await G(r,a.slice(0,-1));if(f){n.setFieldsValue({...f});const P=f.image_path?f.image_path.split(",").map((L,F)=>({uid:F.toString(),name:`image-${F}`,status:"done",url:`https://gas159.ru/api/${L.trim()}`})):[];o(P)}}})()},[r,t,n,a]);const d=({fileList:j})=>{o(j)},u=async j=>{l(!0);try{j.images=i,await lt(r,j),w.getDetails("plates"),s()}catch(f){console.error("Ошибка при обновлении данных:",f)}finally{l(!1)}};return e.jsx(H,{title:"Редактирование пластины",open:t,footer:null,onCancel:s,children:e.jsxs(c,{form:n,onFinish:u,children:[e.jsx(c.Item,{label:"Тип",name:"type",rules:[{required:!0,message:"Введите тип!"}],children:e.jsx(h,{})}),e.jsx(c.Item,{label:"Подтип",name:"sub_type",rules:[{required:!0,message:"Введите подтип!"}],children:e.jsx(h,{})}),e.jsx(c.Item,{label:"Материал",name:"material",rules:[{required:!0,message:"Введите материал!"}],children:e.jsx(h,{})}),e.jsx(c.Item,{label:"Количество",name:"amount",rules:[{required:!0,message:"Введите количество!"}],children:e.jsx(h,{type:"number"})}),e.jsx(c.Item,{label:"Компания",name:"company",rules:[{required:!0,message:"Введите компанию!"}],children:e.jsx(h,{})}),e.jsx(c.Item,{label:"Изображение",name:"images",children:e.jsx(A,{fileList:i,onChange:d,beforeUpload:()=>!1,children:e.jsx(I,{icon:e.jsx(q,{}),children:"Нажмите, чтобы загрузить"})})}),e.jsx(c.Item,{label:"Описание",name:"description",children:e.jsx(h.TextArea,{rows:4})}),e.jsx(I,{type:"primary",htmlType:"submit",loading:m,children:"Сохранить изменения"})]})})},Lt=({id:r,visible:t,onClose:s,activeItem:a})=>a==="drills"?e.jsx(_t,{id:r,visible:t,onClose:s,activeItem:"drills"}):a==="screws"?e.jsx(Ft,{id:r,visible:t,onClose:s,activeItem:"screws"}):a==="plates"?e.jsx(kt,{id:r,visible:t,onClose:s,activeItem:"plates"}):null,Tt=V(()=>{const[r,t]=p.useState(!1),[s,a]=p.useState([]),[n,i]=p.useState(!1),o=J().pathname.slice(1),m=T();p.useEffect(()=>{(async()=>{await w.getDetails(o),w.isError&&m("/error")})(),a([])},[o,m]);const l=x=>{w.getDetailIdEdit(x),i(!0)},d=()=>{i(!1)};let u=X(l);const j=s.length?w.details.filter(x=>{if(x.diameter)return s.includes(x.diameter);if(x.length)return s.includes(x.length);if(x.amount)return s.includes(x.amount)}):w.details;switch(o){case"drills":u=X(l);break;case"screws":u=St(l);break;case"plates":u=Dt(l);break;case"archive_drills":u=X(l);break}const f=()=>{t(!0)},P=()=>{t(!1)},L=()=>{a([]),t(!1)},F=(x,M)=>{console.log("params",x,M)},{mode:K}=O();return e.jsxs(e.Fragment,{children:[e.jsx(It,{openFilter:f,activeItems:o}),s.length>0&&e.jsxs("div",{style:{marginBottom:"5px"},children:[e.jsx("h4",{children:"Применённые фильтры:"}),s.map(x=>e.jsxs(Je,{color:"blue",style:{marginRight:"5px"},children:[x," мм"]},x)),e.jsx(I,{type:"link",onClick:L,children:"Сбросить фильтры"})]}),e.jsx(He,{className:K==="light"?"light-theme":"dark-theme",rowKey:"id",columns:u,dataSource:j,onChange:F,scroll:{x:1e3,y:55*5},pagination:!1,onRow:x=>({onClick:()=>{w.getDetailIdDescription(x.id)},style:{cursor:"pointer"}})}),e.jsx(Ct,{closeFilterDrawer:P,drawerVisible:r,setSelectedParameters:a,selectedParameters:s,resetFilter:L}),e.jsx(Lt,{id:w.idDetailEdit,activeItem:o,visible:n,onClose:d})]})}),Pt=({item:r})=>e.jsx(e.Fragment,{children:e.jsxs(D,{sx:{flex:1,mr:{sm:2,xs:0},mb:{xs:2,sm:0}},children:[e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["ID: ",r.id]}),e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["Название: ",r.name]}),e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["Диаметр: ",r.diameter]}),e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["Длина: ",r.length_xD]}),e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["Глубина сверления: ",r.deep_of_drill]}),e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["Компания: ",r.company]}),e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["Описание: ",r.description]})]})}),$t=({item:r})=>e.jsx(e.Fragment,{children:e.jsxs(D,{sx:{flex:1,mr:{sm:2,xs:0},mb:{xs:2,sm:0}},children:[e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["ID: ",r.id]}),e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["Тип: ",r.type]}),e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["Длина: ",r.length]}),e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["Резьба: ",r.thread]}),e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["Шаг резьбы: ",r.step_of_thread]}),e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["Компания: ",r.company]}),e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["Описание: ",r.description]})]})}),Bt=({item:r})=>e.jsx(e.Fragment,{children:e.jsxs(D,{sx:{flex:1,mr:{sm:2,xs:0},mb:{xs:2,sm:0}},children:[e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["ID: ",r.id]}),e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["Тип: ",r.type]}),e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["Материал: ",r.material]}),e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["Количество: ",r.amount]}),e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["Компания: ",r.company]}),e.jsxs(g,{gutterBottom:!0,sx:{fontSize:14},children:["Описание: ",r.description]})]})}),Et=V(()=>{const[r,t]=p.useState(null),[s,a]=p.useState(!0),[n,i]=p.useState(0),o=J().pathname.slice(1);if(p.useEffect(()=>{const j=async()=>{a(!0);const f=await G(w.idDetailDescription,o.slice(0,-1));f&&t(f),a(!1)};w.idDetailDescription!==null&&j()},[w.idDetailDescription]),s)return e.jsx("div",{children:"Loading..."});if(r===null)return e.jsx("div",{children:"Выберите строку"});const m=r.image_path?r.image_path.split(",").map(j=>j.trim()):[],l=m.length>0,d=()=>{i(j=>j===0?m.length-1:j-1)},u=()=>{i(j=>j===m.length-1?0:j+1)};return e.jsx("div",{children:e.jsx(xe,{sx:{minWidth:275,padding:2,mt:4},children:e.jsxs(D,{display:"flex",flexDirection:{xs:"column",sm:"row"},children:[o==="drills"||o==="archive_drills"?e.jsx(Pt,{item:r}):o==="screws"?e.jsx($t,{item:r}):o==="plates"?e.jsx(Bt,{item:r}):e.jsx("div",{children:"Неверный тип данных"}),e.jsxs(D,{sx:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",position:"relative"},children:[e.jsx(D,{sx:{display:"flex",justifyContent:"center",alignItems:"center",maxWidth:"100%",mb:1},children:e.jsx("img",{src:`https://gas159.ru/api/${m[n]}`,alt:"Изображение не найдено",style:{height:"auto",width:"100%",maxWidth:"200px",border:"2px solid rgb(224, 224, 224)",borderRadius:"4px"}})}),e.jsx(D,{sx:{fontSize:"14px",color:"gray"},children:l?`${n+1}/${m.length}`:"Нет изображений"}),e.jsxs(D,{display:"flex",justifyContent:"center",alignItems:"center",children:[e.jsx($,{onClick:d,disabled:!l||n===0,children:e.jsx(qe,{})}),e.jsx($,{onClick:u,disabled:!l||n===m.length-1,children:e.jsx(Oe,{})})]})]})]})})})}),R=()=>e.jsxs("div",{children:[e.jsx(Z,{}),e.jsx(ye,{}),e.jsxs(E,{children:[e.jsx(Tt,{}),e.jsx(Et,{})]})]}),At=()=>{const r=T(),{email:t,logout:s}=fe(),a=()=>{s(),r("/")};return e.jsxs(e.Fragment,{children:[e.jsx(Z,{}),e.jsxs(E,{children:[e.jsx(g,{variant:"h4",gutterBottom:!0,sx:{textAlign:"center",mt:4},children:"Личный кабинет"}),e.jsxs(xe,{sx:{maxWidth:345,m:2},children:[e.jsx(Me,{avatar:e.jsx(Ne,{alt:"Ted talk"}),title:`User name: ${t}`,subheader:"Role"}),e.jsx(ze,{children:e.jsx(k,{variant:"contained",color:"primary",onClick:a,children:"Logaut"})})]})]})]})},qt=()=>{const r=T(),t=()=>{r("/")};return e.jsx(E,{sx:{textAlign:"center",marginTop:"50px"},children:e.jsxs(D,{children:[e.jsx(g,{variant:"h4",gutterBottom:!0,children:"Ведутся технические работы"}),e.jsx(g,{variant:"body1",gutterBottom:!0,children:"Мы скоро вернемся. Попробуйте обновить страницу позже."}),e.jsx(k,{variant:"contained",color:"primary",onClick:t,children:"На главную"})]})})},Ot=()=>{const r=T(),t=()=>{r("/")};return e.jsxs(E,{style:{textAlign:"center",marginTop:"50px"},children:[e.jsx(g,{variant:"h4",gutterBottom:!0,children:"Страница не найдена"}),e.jsx(k,{variant:"contained",color:"primary",onClick:t,children:"На главную"})]})},Mt=()=>{const{theme:r}=O();return e.jsxs(ve,{theme:r,children:[e.jsx(Re,{}),e.jsx(Se,{children:e.jsxs(Ue,{children:[e.jsx(_,{path:"/",element:e.jsx(st,{})}),e.jsx(_,{path:"/register",element:e.jsx(Ye,{})}),e.jsx(_,{path:"/login",element:e.jsx(Xe,{})}),e.jsx(_,{path:"/drills",element:e.jsx(R,{})}),e.jsx(_,{path:"/screws",element:e.jsx(R,{})}),e.jsx(_,{path:"/plates",element:e.jsx(R,{})}),e.jsx(_,{path:"archive_drills",element:e.jsx(R,{})}),e.jsx(_,{path:"/account",element:e.jsx(At,{})}),e.jsx(_,{path:"/error",element:e.jsx(qt,{})}),e.jsx(_,{path:"*",element:e.jsx(Ot,{})})]})})]})},U=S.create({withCredentials:!0,baseURL:"https://gas159.ru/api/"});U.interceptors.request.use(r=>(r.headers.Authorization=`Bearer ${localStorage.getItem("token")}`,r));class Q{static async login(t,s){const a=new URLSearchParams;return a.append("username",t),a.append("password",s),U.post("auth/jwt/login",a,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})}static async registration(t,s){return U.post("auth/register",{email:t,password:s})}static async logout(){return U.post("auth/jwt/logout")}}class Nt{constructor(){this.user={},this.isAuth=!1,this.isLoading=!1,Y(this)}setAuth(t){this.isAuth=t}setUsers(t){this.user=t}setLoading(t){this.isLoading=t}async login(t,s){try{const a=await Q.login(t,s);console.log(a),localStorage.setItem("token",a.data.accessToken),this.setAuth(!0),this.setUsers(a.data.user)}catch(a){console.log(a)}}async registration(t,s){try{const a=await Q.registration(t,s);console.log(a),localStorage.setItem("token",a.data.accessToken),this.setAuth(!0),this.setUsers(a.data.user)}catch(a){console.log(a)}}async logout(){try{const t=await Q.logout();console.log(t),localStorage.removeItem("token"),this.setAuth(!1),this.setUsers({})}catch(t){console.log(t)}}async checkAuth(){this.setLoading(!0);try{const t=await S.get("https://gas159.ru/api//refresh",{withCredentials:!0});console.log(t),localStorage.setItem("token",t.data.accessToken),this.setAuth(!0),this.setUsers(t.data.user)}catch(t){console.log(t)}finally{this.setLoading(!1)}}}const we=new Nt,zt=p.createContext({regStore:we});Ce(document.getElementById("root")).render(e.jsx(et,{children:e.jsx(zt.Provider,{value:{regStore:we},children:e.jsx(Mt,{})})}));
